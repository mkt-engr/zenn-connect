---
title: "画面遷移時に不要なAPI通信を中止してパフォーマンスを向上させる"
emoji: "👺"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["React", "TypeScript", "Axios"]
published: false
---

# 概要

画面遷移した際に API で特定のユーザーの情報を取得しブラウザに表示するシュチュエーションを考えます。4 つのボタンがありそれぞれのボタンをクリックするとそれぞれ異なるユーザーが表示されます。
![](/images/example.png)

この時、最初は 1 をクリックのユーザー情報の表示を待っていた時に「やっぱりユーザー 2 の情報が欲しいから 2 をクリックしよう」と思った場合に表示する必要のないユーザー 1 のレスポンスは不要ですよね。このような不要なレスポンスを返すリクエストを打ち切るする方法について記事にしました。

後ほどコードはお見せしますが私の好きな React で書いています。ですが考え方自体はプレーンな JavaScript でも Vue でも生かせると思います。

# 事前準備

実際にコードを動かす前に不要なリクエストを打ち切った場合とそうでない場合の違いをわかりやすくするためにブラウザの開発者ツールから通信速度の調整をします。

ネットワークタブを開いて以下の画像のように No throttling をクリックし Slow 3G を選択してください。こうすることで通信速度が遅くなり、不要なレンダリングが発生しないことがわかりやすくなります。

![](/images/network1.png)
![](/images/network2.png)

# リクエストを中止する場合としない場合のレンダリングの違い

@[codesandbox](https://codesandbox.io/embed/apitong-xin-wozhong-duan-suru-fz68vf?fontsize=14&hidenavigation=1&theme=dark)

なお、主に利用したライブラリのバージョン情報は以下の通りです。

| ライブラリ       | バージョン |
| ---------------- | ---------- |
| React            | 17.0.0     |
| React-Router-DOM | 6.0.0      |
| Axios            | 0.27.2     |
